<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id='pointage_action' model='ir.actions.act_window'>
        <field name="name"> Rapport de pointage </field>
        <field name="res_model">hr.rapport.pointage</field>
        <field name="view_mode">tree,form,search</field>
    </record>

    <record id="rapport_pointage_tree" model="ir.ui.view">
        <field name="name">Les rapports de pointage</field>
        <field name="model">hr.rapport.pointage</field>
        <field name="priority" eval="1"/>
        <field name="arch" type="xml">
            <tree class="table">
                <field name="name"/>
                <field name="employee_id"/>
                <field name="period_id" /> 
                <field name="chantier_id"/>
                <!-- <field name="vehicle_id"/> -->
                <field name="emplacement_chantier_id"/>
                <field name="total_h" />
                <field name="total_j" />
                <field name="total_h_v" />
                <field name="total_j_v" />
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="rapport_pointage_form" model="ir.ui.view">
        <field name="name">rapport.pointage.form</field>
        <field name="model">hr.rapport.pointage</field>
        <field name="priority" eval="1"/>
        <field name="arch" type="xml">
            <form>
                <header attrs="{'invisible': [('employee_type','=','o'),('quinzaine','!=','quinzaine12'),('periodicite','=','1')]}">
                    <button name="action_draft" states="cancel,valide,compute,working" string="Mettre en brouillon" type="object" class="oe_highlight" groups="hr_management.group_admin_paie"/>
                    <button name="action_working" states="draft" string="Traiter" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <button name="action_working" states="compute" string="Retourner" type="object" class="oe_highlight" groups="hr_management.group_agent_paie"/>
                    <button name="action_working" states="valide,done" string="Retourner" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_controle_gestion"/>
                    <button name="action_done" states="valide" string="Clôturer" type="object" class="oe_highlight" groups="hr_management.group_controle_gestion,hr_management.group_admin_paie"/>
                    <button name="action_cancel" states="draft,valide,done" string="Annuler" type="object" class="oe_highlight" groups="hr_management.group_admin_paie"/>
                    <button name="create_q12_payslip" string="Payé Mois" states="working" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,working,compute,valide,done"/>
                </header>
                <header attrs="{'invisible': ['|','|',('employee_type','!=','s'),('quinzaine','!=','quinzaine1'),('periodicite','=','2')]}">
                    <button name="action_q1_draft" attrs="{'invisible': [('q1_state','in',('q1_draft'))]}" string="Mettre en brouillon" type="object" class="oe_highlight" groups="hr_management.group_admin_paie"/>
                    <button name="action_q1_working" attrs="{'invisible': [('q1_state','!=','q1_draft')]}" string="Traiter" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <button name="action_q1_working" attrs="{'invisible': [('q1_state','!=','q1_compute')]}" string="Retourner" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <button name="action_q1_working" attrs="{'invisible': [('q1_state','not in',('q1_valide','q1_compute'))]}" string="Retourner" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_controle_gestion"/>
                    <button name="action_q1_done"  attrs="{'invisible': [('q1_state','!=','q1_valide')]}" string="Clôturer" type="object" class="oe_highlight" groups="hr_management.group_controle_gestion,hr_management.group_admin_paie"/>
                    <button name="create_q1_payslip" attrs="{'invisible': [('q1_state','!=','q1_working')]}" string="Payé Q1" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <field name="q1_state" widget="statusbar"/>
                </header>
                <header attrs="{'invisible': ['|','|',('employee_type','!=','s'),('quinzaine','!=','quinzaine2'),('periodicite','=','2')]}">
                    <button name="action_q2_draft" attrs="{'invisible': [('q2_state','in',('q2_draft'))]}" string="Mettre en brouillon" type="object" class="oe_highlight" groups="hr_management.group_admin_paie"/>
                    <button name="action_q2_working" attrs="{'invisible': [('q2_state','!=','q2_draft')]}" string="Traiter" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <button name="action_q2_working" attrs="{'invisible': [('q2_state','!=','q2_compute')]}" string="Retourner" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <button name="action_q2_working" attrs="{'invisible': [('q2_state','not in',('q2_valide','q2_compute'))]}" string="Retourner" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_controle_gestion"/>
                    <button name="action_q2_done"  attrs="{'invisible': [('q2_state','!=','q2_valide')]}" string="Clôturer" type="object" class="oe_highlight" groups="hr_management.group_controle_gestion,hr_management.group_admin_paie"/>
                    <button name="create_q2_payslip" attrs="{'invisible': [('q2_state','!=','q2_working')]}" string="Payé Q2" type="object" class="oe_highlight" groups="hr_management.group_admin_paie,hr_management.group_agent_paie"/>
                    <field name="q2_state" widget="statusbar"/>
                </header>
                <sheet>
                    <notebook>
                        <page string="Infos Rapport">
                            <group>
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <h1>Informations Historiques</h1>
                                        </div>
                                        <div class="panel-body">
                                            <div class="row">
                                                <field name="data_html"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </group>
                            <group>
                                <div class="col-md-12">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            Rapport N°
                                            <h1>
                                                <field name="name" class="oe_inline" attrs="{'invisible': [('name','=','/')]}" readonly="1" />
                                            </h1>
                                        </div>
                                        <div class="panel-body">
                                                <div class="col-md-12 ">
                                                    <group>    
                                                        <group>
                                                            <field name="employee_id"  options="{'no_create': True,'no_open':True}"/>
                                                            <field name="employee_type"/>
                                                            <field name="cin"/>
                                                            <field name="job_id"/>
                                                            <field name="period_id" />
                                                            <field name="periodicite" />
                                                            <field name="quinzaine" />
                                                            <field name="chantier_id" options="{'no_create': True}"/>
                                                            <field name="periodicite" invisible="1"/>
                                                            <!-- <field name="vehicle_id" options="{'no_create': True}" /> -->
                                                            <field name="emplacement_chantier_id" options="{'no_create': True}" /> 
                                                        </group>
                                                    </group>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="row">
                                                        <div class="col-md-3 col-sm-2 panel-group">
                                                            <div class="panel panel-primary">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="total_h"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="total_h" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-2">
                                                            <div class="panel panel-success">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="total_h_v"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="total_h_v" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-2">
                                                            <div class="panel panel-warning">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="total_h_sup"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="total_h_sup" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3"> 
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-3 col-sm-2 panel-group">
                                                            <div class="panel panel-primary">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="total_j"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="total_j" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-2">
                                                            <div class="panel panel-success">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="total_j_v"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="total_j_v" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>                                
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-3 col-sm-2 panel-group">
                                                            <div class="panel panel-info">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="count_nbr_holiday_days"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="count_nbr_holiday_days" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-2 panel-group">
                                                            <div class="panel panel-info">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="count_nbr_ferier_days"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="count_nbr_ferier_days" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-2 panel-group">
                                                            <div class="panel panel-default">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="count_nbr_dim_days"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="count_nbr_dim_days" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-3 col-sm-2 panel-group">
                                                            <div class="panel panel-danger">
                                                                <div class="panel-heading">
                                                                    <h3 class="text-center">
                                                                        <label for="count_nbr_absense_days"/>
                                                                    </h3>
                                                                </div>
                                                                <div class="panel-body">
                                                                    <h1 class="text-center">
                                                                        <field name="count_nbr_absense_days" />
                                                                    </h1>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                        </div>
                                    </div>
                                </div> 
                            </group>
                        </page>
                        <page string="Infos Fiche Paie">
                            <group>
                                <field name="payslip_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name" />
                                        <field name="period_id" />
                                        <field name="net_pay" />
                                        <field name="chantier_id"/>
                                        <field name="emplacement_chantier_id" />
                                        <!-- <field name="vehicle_id" /> -->
                                        <!-- <button name="open_payslip" type="object" class="oe_highlight oe_edit_only" string="Consulter" /> -->
                                    </tree>
                                </field>
                            </group>
                        </page>
                        <page string="Infos Congés">
                            <field name="holiday_ids" nolabel="1">
                                <tree>
                                    <field name="chantier_id" options="{'no_create': True,'no_open': True}" string="Chantier"/>
                                    <field name="motif"/>
                                    <field name="date_start" string="Date Début"/>
                                    <field name="date_end" string="Date Fin"/>
                                    <field name="duree_jours" string="Nbr Jours"/>
                                    <field name="state"/>
                                    <!-- <button name="open_holiday" type="object" class="oe_highlight oe_edit_only" string="Consulter" /> -->
                                </tree>
                            </field>   
                        </page>   
                        <!-- <page string="Infos Transfert">
                            <field name="transfert_ids" nolabel="1">
                                <tree>
                                    <field name="name" options="{'no_create': True,'no_open': True}" string="Chantier"/>
                                    <field name="chantier_id_source"/>
                                    <field name="chantier_id_destiation"/>
                                    <field name="date_transfert" string="Date Transfert"/>
                                    <field name="date_arriver" string="Date Arrivé"/>
                                    <field name="state"/>
                                    <button name="open_transfert" type="object" class="oe_highlight oe_edit_only" string="Consulter" />
                                </tree>
                            </field>
                        </page>  -->
                    </notebook>
                </sheet>
                <sheet class="custom_sheet">
                    <div class="row">
                        <div class="col-md-2 col-sm-2 panel-group">
                            <div class="panel panel-danger">
                                <div class="panel-heading">
                                    <h3 class="text-center">
                                        <label for="etat"/>
                                    </h3>
                                </div>
                                <div class="panel-body">
                                    <h3 class="text-center">
                                        <field name="etat" readonly="1"/>
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4 panel-group">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    LÉGENDE
                                </div>
                                <div class="panel-body">
                                    <div class="col-md-6">
                                        <div class="row" style="color:black;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:black;"></span>Jours Ouvrable</div>
                                        <div class="row" style="color:skyblue;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:skyblue;"></span>Jours Férié</div>
                                        <div class="row" style="color:blue;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:blue;"></span>Congé</div>
                                        <div class="row" style="color:grey;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:grey;"></span>Dimanche</div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="row" style="color:tomato;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:tomato;"></span>Absense non Autorié</div>
                                        <div class="row" style="color:crimson;width:200px;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:crimson;"></span>Abondement de Poste</div>
                                        <div class="row" style="color:crimson;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:crimson;"></span>Accident Travail</div>
                                        <div class="row" style="color:slategrey;"><span style="border: 1px solid #ccc; float: left; width: 35px; height: 20px; margin: 2px; background-color:slategrey;"></span>STC</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <group string="">
                            <field name="rapport_lines" nolabel="1">
                            <tree editable="bottom" colors="black:day_type=='1'; grey:day_type=='2'; skyblue:day_type=='3'; blue:day_type=='4'; tomato:day_type=='5'; crimson:day_type=='6'; slategrey:day_type=='7';">
                                <field name="name"/>
                                <field name="h_travailler" string="TH"/>
                                <field name="h_travailler_v" string="THV"/>
                                <field name="h_sup" string="Supp >> 9"/>
                                <field name="h_bonus" string="Bonus"/>
                                <field name="j_travaille_v" string="TJV"/>
                                <field name="chantier_id" options="{'no_create': True,'no_open': True}"/>
                                <!-- <field name="vehicle_id"  options="{'no_create': True,'no_open': True}" readonly="1" invisible="1"/> -->
                                <!-- <field name="vehicle_ids_resume"/> -->
                                <button name="update_engin_list" type="object" class="oe_highlight oe_edit_only" string="OPEN" icon="gtk-open" />
                                <field name="emplacement_chantier_id"  options="{'no_create': True,'no_open': True}" string="Équipe"/>
                                <!-- <field name="details" />                                            -->
                                <field name="note" />
                                <field name="day_type"/>    
                                <field name="state" invisible="1"/>
                                <field name="day" invisible="1"/>
                                <button name="update_wizard_ref_view" type="object" class="oe_highlight oe_edit_only" string="OPEN" icon="gtk-edit" />
                            </tree>
                        </field>
                    </group>
                </sheet> 
                <sheet>
                    <group string="">
                            <field name="note"/>
                    </group>
                </sheet> 
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>     
            </form>
        </field>
    </record>

    <!-- <record id="directeur_search" model="ir.ui.view">
        <field name="name">Directeur Recherche</field>
        <field name="model">hr.directeur</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" />
                <field name="poste"/>		
            </search>
        </field>
    </record> -->

    <record id="view_engins_list_view" model="ir.ui.view">
        <field name="name">engin.list</field>
        <field name="model">hr.rapport.pointage.line.engin</field>
        <field name="arch" type="xml">
            <form>
                <group string="">
                    <group string="">
                        <field name="name"  options="{'no_create': True,'no_open': True}"/>
                        <field name="time_start"/>
                        <field name="time_end"/>
                    </group>
                    <group string="">
                    </group>
                </group>

                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>     
            </form>

        </field>
    </record>

    <record id="view_engin_list_view" model="ir.ui.view">
        <field name="name">engins.list</field>
        <field name="model">hr.rapport.pointage.line</field>
        <field name="arch" type="xml">
            <form>
                <group string="">   
                    <field name="vehicle_ids" colspan="4" nolabel="1" >
                        <tree editable="bottom">
                            <field name="name"  options="{'no_create': True,'no_open': True}"/>
                            <field name="time_start"/>
                            <field name="time_end"/>
                        </tree>
                    </field>
                </group>
                <footer>
                    <button name="save_engin_list" type="object" class="oe_highlight oe_edit_only" string="Enregistrer" />
                </footer>
            </form>
        </field>
    </record>
    <record id="view_engin_list_view_manager" model="ir.ui.view">
        <field name="name">engins.list</field>
        <field name="model">hr.rapport.pointage.line</field>
        <field name="arch" type="xml">
            <form>
                <group string="">   
                    <field name="vehicle_ids" colspan="4" nolabel="1" readonly="1">
                        <tree>
                            <field name="name"  options="{'no_create': True,'no_open': True}"/>
                            <field name="time_start"/>
                            <field name="time_end"/>
                        </tree>
                    </field>
                </group>
            </form>
        </field>
    </record>
</odoo>